(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6bca1707"],{"41df":function(e,l,t){"use strict";t("f731")},aee3:function(e,l,t){"use strict";t.r(l);var i,s,a=t("0e92"),o=t("8f61"),c=t("432a"),n=t("2178"),r=(t("3b69"),t("60d8"),t("76d5"),t("7f82"),t("2e53"),t("d61a"),t("49bc"),t("376b"),t("6416"),t("839f"),t("365c")),u={name:"global-rule-dialog",props:{visible:{type:Boolean,default:!1},unblocked:{type:Boolean,default:!1}},render:function(){var e=this,l=arguments[0];return l("el-dialog",{class:"global-rule-dialog",attrs:{visible:this.visible,width:"32%","show-close":!1,placement:"bottom",center:!0},on:{close:function(){return e.close()}}},[l("div",{slot:"title"},["新建",this.unblockedCom,"规则"]),l("div",{class:"g-r-container"},[l("div",{class:"g-r-c-checkbox"},[this.unblocked?null:l("el-checkbox",{attrs:{border:!0,size:"small"},model:{value:e.rule.abroadDisabled,callback:function(l){e.$set(e.rule,"abroadDisabled",l)}}},["禁止境外"]),this.unblocked?null:l("el-checkbox",{attrs:{border:!0,size:"small"},model:{value:e.rule.limitDisabled,callback:function(l){e.$set(e.rule,"limitDisabled",l)}}},["频率检测"]),l("el-checkbox",{attrs:{border:!0,size:"small"},model:{value:e.rule.portsDisabled,callback:function(l){e.$set(e.rule,"portsDisabled",l)}}},["端口检测"]),l("el-checkbox",{attrs:{border:!0,size:"small"},model:{value:e.rule.ipsDisabled,callback:function(l){e.$set(e.rule,"ipsDisabled",l)}}},["IP 检测"]),l("el-checkbox",{attrs:{border:!0,size:"small"},model:{value:e.rule.sitesDisabled,callback:function(l){e.$set(e.rule,"sitesDisabled",l)}}},["关键词检测"]),this.unblocked?null:l("el-checkbox",{attrs:{border:!0,size:"small"},model:{value:e.rule.shieldTimeDisabled,callback:function(l){e.$set(e.rule,"shieldTimeDisabled",l)}}},["屏蔽时长"])]),this.rule.limitDisabled&&0==this.unblocked?l("div",{class:"g-r-c-traffic"},[l("el-select",{attrs:{placeholder:"时间范围",clearable:!0},model:{value:e.rule.limitShield,callback:function(l){e.$set(e.rule,"limitShield",l)}}},[this.limitOptions.map((function(e){return l("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))]),l("el-input-number",{attrs:{min:1,max:9999,clearable:!0,label:"访问总量/单位次"},model:{value:e.rule.limitTotal,callback:function(l){e.$set(e.rule,"limitTotal",l)}}})]):null,this.rule.portsDisabled?l("div",{class:"g-r-c-item"},[l("global-rule-project-select",{attrs:{multiple:!0},on:{change:function(l){return e.projectSelectChange(l)}}})]):null,this.rule.ipsDisabled?l("div",{class:"g-r-c-item"},[l("el-input",{attrs:{type:"textarea",rows:2,clearable:!0,maxlength:200,placeholder:"根据 IP ".concat(this.unblockedCom,",不填会").concat(this.unblockedCom,"所有 IP")},model:{value:e.rule.ips,callback:function(l){e.$set(e.rule,"ips",l)}}},[l("template",{slot:"append"},[l("el-button",{attrs:{type:"primary",icon:"el-icon-plus"}})])])]):null,this.rule.sitesDisabled?l("div",{class:"g-r-c-item"},[l("el-input",{attrs:{type:"textarea",rows:3,clearable:!0,maxlength:200,placeholder:"根据地区关键词".concat(this.unblockedCom,",不填会").concat(this.unblockedCom,"所有地区,多个关键词换行间隔,如: 北京 ,检测到 北京 的 IP 就会被").concat(this.unblockedCom)},model:{value:e.rule.sites,callback:function(l){e.$set(e.rule,"sites",l)}}},[l("template",{slot:"append"},[l("el-button",{attrs:{type:"primary",icon:"el-icon-plus"}})])])]):null,this.rule.shieldTimeDisabled&&0==this.unblocked?l("div",{class:"g-r-c-item"},[l("el-select",{attrs:{size:"small",placeholder:"屏蔽时长",clearable:!0},model:{value:e.rule.shieldTime,callback:function(l){e.$set(e.rule,"shieldTime",l)}}},[this.shieldTimeOptions.map((function(e){return l("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))])]):null,l("div",{class:"g-r-c-item"},[l("el-alert",{attrs:{title:"注意:".concat(this.unblocked?"全部符合才会被允许":"符合其中一项就会被屏蔽"),type:"success"}})])]),l("div",{slot:"footer",class:"dialog-footer"},[l("el-button",{on:{click:function(){return e.$emit("close")}}},["取 消"]),l("el-button",{attrs:{type:"primary",loading:this.loading},on:{click:function(){return e.confirm()}}},["确 定"])])])},computed:{unblockedCom:function(){return this.unblocked?"允许":"屏蔽"}},data:function(){return{limitOptions:[{value:30,label:"30分钟"},{value:60,label:"60分钟"},{value:90,label:"90分钟"},{value:120,label:"120分钟"},{value:150,label:"150分钟"},{value:180,label:"180分钟"}],shieldTimeOptions:[{value:60,label:"1小时"},{value:86400,label:"24小时"},{value:172800,label:"48小时"},{value:259200,label:"72小时"},{value:31536e3,label:"一年"}],rule:{ips:"",sites:"",ports:"",limitShield:30,limitTotal:100,shieldTime:259200,abroadDisabled:!0,limitDisabled:!1,ipsDisabled:!1,portsDisabled:!1,sitesDisabled:!1,shieldTimeDisabled:!1}}},methods:{close:function(){this.$emit("close")},onEnter:function(){},projectSelectChange:function(e){this.rule.ports=e},confirm:function(){var e=this;return Object(n["a"])(Object(a["a"])().mark((function l(){var t,i,s,n,u,d,b,m,p,h,v,f,k;return Object(a["a"])().wrap((function(l){while(1)switch(l.prev=l.next){case 0:return m=null!==(t=null===(i=e.rule.ips)||void 0===i?void 0:i.split(/\n{1,}/g).filter((function(e){return/^((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.){3}(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])(?::(?:[0-9]|[1-9][0-9]{1,3}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5]))?$/.test(e)})).reduce((function(e,l){return e.includes(l)?e:e=[].concat(Object(c["a"])(e),[l])}),[]))&&void 0!==t?t:[],console.log(m),p=null!==(s=null===(n=e.rule.sites)||void 0===n?void 0:n.split(/\n{1,}/g).filter((function(e){return""!=e})))&&void 0!==s?s:[],h=null!==(u=null===(d=(b=e.rule.ports).filter)||void 0===d?void 0:d.call(b,(function(e){return""!=e})))&&void 0!==u?u:[],l.next=6,Object(r["b"])(Object(o["a"])(Object(o["a"])({},e.rule),{},{ports:h,ips:m,sites:p,unblocked:e.unblocked}));case 6:v=l.sent,f=v.success,k=v.data,f?(e.$emit("confirm"),e.rule={ips:"",sites:"",ports:"",limitShield:30,limitTotal:100,shieldTime:259200,abroadDisabled:!0,limitDisabled:!1,ipsDisabled:!1,portsDisabled:!1,sitesDisabled:!1,shieldTimeDisabled:!1}):e.$message({showClose:!0,message:k.message,type:"error"});case 10:case"end":return l.stop()}}),l)})))()}}},d=u,b=(t("41df"),t("3427")),m=Object(b["a"])(d,i,s,!1,null,"2c93b04d",null);l["default"]=m.exports},f731:function(e,l,t){}}]);