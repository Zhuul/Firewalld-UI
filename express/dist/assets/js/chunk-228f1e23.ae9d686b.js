(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-228f1e23"],{"4c7d":function(e,t,l){"use strict";l("773e")},"74bf":function(e,t,l){"use strict";var i="0123456789",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",a="~!@#$%^*()_+-=[]{}|;:,./<>?";function r(e,t){e||(e=8),t||(t={});var l="",r="";!0===t?l=i+n+a:"string"==typeof t?l=t:(!1!==t.numbers&&(l+="string"==typeof t.numbers?t.numbers:i),!1!==t.letters&&(l+="string"==typeof t.letters?t.letters:n),t.specials&&(l+="string"==typeof t.specials?t.specials:a));while(e>0)e--,r+=l[Math.floor(Math.random()*l.length)];return r}e.exports=r.default=r},"773e":function(e,t,l){},"91b7":function(e,t,l){"use strict";l.r(t);var i,n,a=l("0e92"),r=l("2178"),o=l("8f61"),s=(l("7f82"),l("6d61"),l("ede0"),l("b69e"),l("ed7c"),l("60d8"),l("3b69"),l("dda2"),l("d2f5"),l("6e0e")),u=l.n(s),c=l("74bf"),d=l.n(c),f=l("6912"),p=l("365c"),b=l("f0a4"),h=(l("f747"),{name:"Rule",components:{CreateProjectDialog:function(){return{component:l.e("chunk-a51c95cc").then(l.bind(null,"98f4"))}}},beforeRouteEnter:function(e,t,l){l((function(e){e.otherMutationsMenuActive("management-rule")}))},render:function(){var e=this,t=arguments[0];return t("div",{class:"rule"},[t("div",{class:"r-bar"},[t("div",{class:"r-b-item"},[t("global-rule-popover",{on:{confirm:function(t){return e.popoverConfirm(t)}}})]),t("div",{class:"r-b-item"},[t("global-delete-popover",{attrs:{disabled:0==this.selection.length},on:{confirm:function(){return e.deleteConfirm()}}})]),t("div",{class:"r-b-item"},[t("el-alert",{attrs:{title:"注意:拖拽修改权重,越靠上权重越大",type:"success"}})])]),t("global-rule-dialog",{attrs:{visible:this.dialogVisible,unblocked:this.unblocked},on:{close:function(){return e.dialogVisible=!1},confirm:function(){return e.dialogConfirm()}}}),t("global-table",{attrs:{sort:!0,uuid:this.uuid,api:p["q"],params:{effective:this.query.effective},pageSizeProp:1e4,edit:this.edit,column:this.column},on:{sort:function(t){return e.sort(t)},before:function(){return e.triggerLoading(!0)},complete:function(){return e.triggerLoading(!1)},"selection-change":function(t){return e.selectionChange(t)}}})])},watch:{edit:{deep:!0,handler:function(e,t){e.mode?this.onEnter():u.a.unbind("enter")}}},inject:["triggerLoading","reload"],data:function(){var e=this,t=this.$createElement;return{selection:[],uuid:d()(),edit:{index:null,mode:!1,key:""},column:[{type:"selection",width:"55"},{type:"expand",label:"详细",width:60,default:function(e,l,i){var n=e.ipsDisabled?0==e.ips.length?"所有的 IP 都会检测":e.ips.join("; "):"不检测 IP",a=e.portsDisabled?""==e.ports?"所有的 端口 都会检测":e.ports.join("; "):"不检测端口",r=e.sitesDisabled?""==e.sites?"所有的 地点 都会检测":e.sites.join("; "):"不检测地点",o=[t("div",{class:"t-e-item"},[t("label",["境外"]),t("label",[e.abroadDisabled?"检测到境外封禁":"检测到境外放行"])]),t("div",{class:"t-e-item"},[t("label",["屏蔽时长"]),t("label",["".concat(Object(f["d"])(e.shieldTime))])]),t("div",{class:"t-e-item"},[t("label",["频率"]),t("label",[e.limitDisabled?"同一 IP ".concat(e.limitShield," 分钟内访问 ").concat(e.limitTotal," 次会被屏蔽"):"不检测频率"])])];return t("div",{class:"table-expand"},[t("div",{class:"t-e-item"},[t("label",["权重"]),t("label",[e.sort," 数字越大权重越大"])]),t("div",{class:"t-e-item"},[t("label",["类型"]),t("label",[e.unblocked?"允许规则":"屏蔽规则"])]),0==e.unblocked?o.map((function(e,t){return e})):null,t("div",{class:"t-e-item"},[t("label",["IP"]),t("label",[n])]),t("div",{class:"t-e-item"},[t("label",["端口"]),t("label",[" ",a," "])]),t("div",{class:"t-e-item"},[t("label",["地点"]),t("label",[" ",r," "])])])}},{prop:"time",label:"创建时间",width:150},{prop:"unblockedText",label:"类型",width:"60",header:function(e){return"类型"},default:function(e,t){return e.unblockedText}},{prop:"ips",label:"IP",className:"ips",header:function(e){return"IP"},default:function(e,t){return e.ipsDisabled?0==e.ips.length?"全部":e.ips.join("; "):"无"}},{prop:"ports",label:"端口",className:"ports",header:function(e){return"端口"},default:function(e,t){return e.portsDisabled?""==e.ports?"全部":e.ports.join("; "):"无"}},{prop:"effective",label:"规则状态",width:150,header:function(l){return t("el-select",{attrs:{clearable:!0,placeholder:"规则状态","popper-class":"global-project-select",loading:e.loading},on:{change:function(){return e.uuid=d()()}},model:{value:e.query.effective,callback:function(t){e.$set(e.query,"effective",t)}}},[e.ruleEffectiveOptions.map((function(e,l){return t("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})}))])},default:function(l,i){return t("global-rule-effective-popover",{attrs:{id:l.id,effective:l.effective},on:{confirm:function(){return e.uuid=d()()}}},[t("global-table-tag",{attrs:{type:l.effective?"":"danger",text:l.effective?"生效":"禁止"}})])}},{prop:"sites",label:"地点",className:"sites",header:function(e){return"地点"},default:function(e,t){return e.sitesDisabled?""==e.sites?"全部":e.sites.join("; "):"无"}}],dialogVisible:!1,unblocked:!1,ruleEffectiveOptions:[{label:"生效",value:!0},{label:"禁止",value:!1}],query:{effective:""},rule:{abroadDisabled:!1,ips:[],sites:[],ports:[]}}},methods:Object(o["a"])(Object(o["a"])({},Object(b["c"])(["otherMutationsMenuActive"])),{},{rowClassName:function(e){var t=e.row;e.rowIndex;return t.unblocked?"row-adopt":"row-shield"},sort:function(e){var t=this;return Object(r["a"])(Object(a["a"])().mark((function l(){return Object(a["a"])().wrap((function(l){while(1)switch(l.prev=l.next){case 0:return l.next=2,Object(p["A"])({sorts:e});case 2:t.$nextTick((function(){return t.uuid=d()()}));case 3:case"end":return l.stop()}}),l)})))()},deleteConfirm:function(){var e=this;return Object(r["a"])(Object(a["a"])().mark((function t(){return Object(a["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.triggerLoading(!0),t.next=3,Object(p["g"])({ids:e.selection});case 3:e.selection=[],e.uuid=d()();case 5:case"end":return t.stop()}}),t)})))()},dialogConfirm:function(){this.dialogVisible=!1,this.uuid=d()()},selectionChange:function(e){this.selection=e.map((function(e){return e.id}))},popoverConfirm:function(e){this.unblocked=e,this.dialogVisible=!0}})}),m=h,v=(l("4c7d"),l("3427")),g=Object(v["a"])(m,i,n,!1,null,"7bb60aa5",null);t["default"]=g.exports},f747:function(e,t,l){"use strict";l("d61a"),l("49bc"),l("2e53"),l("7f82"),l("3b69"),l("d2fb"),l("1752"),l("d61a"),l("49bc"),l("2e53"),l("7f82"),l("ed7c"),l("3b69"),e.exports=function(e){var t=e.Sequelize.DataTypes,l=e.model.define("rule",{id:{type:t.INTEGER,primaryKey:!0,autoIncrement:!0},sort:{type:t.NUMBER,allowNull:!0},limitShield:{type:t.NUMBER,allowNull:!0},limitTotal:{type:t.NUMBER,allowNull:!0},time:{type:t.STRING,allowNull:!1},unblocked:{type:t.BOOLEAN,allowNull:!1},abroadDisabled:{type:t.BOOLEAN,allowNull:!1},limitDisabled:{type:t.BOOLEAN,allowNull:!1},ipsDisabled:{type:t.BOOLEAN,allowNull:!1},portsDisabled:{type:t.BOOLEAN,allowNull:!1},sitesDisabled:{type:t.BOOLEAN,allowNull:!1},shieldTimeDisabled:{type:t.BOOLEAN,allowNull:!1},shieldTime:{type:t.NUMBER,allowNull:!0},unblockedText:{type:t.VIRTUAL,get:function(){return this.getDataValue("unblocked")?"允许":"屏蔽"},set:function(e){throw new Error("不要尝试设置 `unblockedText` 的值!")}},ips:{type:t.STRING,allowNull:!1,get:function(){var e,t,l=this.getDataValue("ips");return null!==(e=null===l||void 0===l||null===(t=l.split)||void 0===t?void 0:t.call(l,",").filter((function(e){return""!=e})))&&void 0!==e?e:[]},set:function(e){return this.setDataValue("ips",e.join(","))}},sites:{type:t.STRING,allowNull:!1,get:function(){var e,t,l=this.getDataValue("sites");return null!==(e=null===l||void 0===l||null===(t=l.split)||void 0===t?void 0:t.call(l,",").filter((function(e){return""!=e})))&&void 0!==e?e:[]},set:function(e){return this.setDataValue("sites",e.join(","))}},ports:{type:t.STRING,allowNull:!1,get:function(){var e,t,l=this.getDataValue("ports");return null!==(e=null===l||void 0===l||null===(t=l.split)||void 0===t?void 0:t.call(l,",").filter((function(e){return""!=e})).map((function(e){return parseInt(e)})))&&void 0!==e?e:[]},set:function(e){return this.setDataValue("ports",e.join(","))}}},{tableName:"rules",timestamps:!1});return l}}}]);